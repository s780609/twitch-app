{"version":3,"sources":["reducer.js","store.js","feature/GetToken.js","feature/GetAccess.js","components/IFrame.js","components/GenerateIFrame.js","components/GenerateVideoCard.js","App.js","index.js"],"names":["redirect_uri","pathname","URL","port","initialState","clientId","clientSecret","accessToken","parentDomain","hostname","createStore","state","action","token","flagString","a","length","result","split","reduce","res","item","parts","access_token","GetToken","claims","twitchUrl","window","location","replace","GetAccess","IFrame","height","width","allowfullscreen","autoplay","videoId","title","parent","description","Card","border","style","src","Header","Body","GenerateIFrame","props","twitchGameData","console","log","CardColumns","map","element","id","GenerateVideoCard","gameName","dispatch","useDispatch","useState","setAccessToken","setTwitchGameData","gameId","setGameId","useSelector","OIDCImplicitCodeFlow","document","hash","substr","access_Token","type","useEffect","axios","get","headers","Authorization","response","status","data","responseGameVideo","Container","Alert","show","variant","App","setGameName","searchValue","setSearchValue","onClick","e","store","Navbar","expand","bg","Nav","className","Brand","Form","inline","FormControl","placeholder","onChange","target","value","onKeyPress","Button","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.ba4c5ca8.chunk.js","sourcesContent":["\r\n//const [token, setToken] = useState(\"\");\r\n\r\n// const redirect_uri =\r\n//     //   \"http://localhost:3000\"\r\n//     `https://s780609.github.io`;\r\n\r\n// const parent =\r\n//     //\"localhost\"\r\n//     `s780609.github.io`;\r\n\r\nconst redirect_uri = \"http://localhost:3000\";\r\n//`https://s780609.github.io/twitch-app`;\r\n\r\nconst port = new URL(redirect_uri).port ? \":\" + new URL(redirect_uri).port : \"\";\r\nconst pathname = new URL(redirect_uri).pathname == \"/\" ? \"\" : new URL(redirect_uri).pathname;\r\nconst parentDomain = new URL(redirect_uri).hostname + pathname; //+ port //+ new URL(redirect_uri).pathname;\r\n\r\nconst initialState = {\r\n    clientId: \"vr0gbze3cw6zvxavzvjjxokdydm7cj\",\r\n    clientSecret: \"3x2oiag46esvkqhp99ah13q1cr3wyk\",\r\n    accessToken: \"\",\r\n    redirect_uri: redirect_uri,\r\n    parentDomain: parentDomain,\r\n};\r\n\r\nexport default (state = initialState, action) => {\r\n    switch (action.accessToken) {\r\n        case \"accessToken\":\r\n            return state = { ...state, token: action.accessToken };\r\n        default:\r\n            return state = { ...state };\r\n    }\r\n}","import { applyMiddleware } from \"redux\";\r\nimport { createStore } from \"redux\";\r\nimport reducer from \"./reducer\";\r\n\r\nexport default createStore(\r\n    reducer,\r\n    //   composeWithDevTools(applyMiddleware(thunk))\r\n);","// setAccessToken is a function of parent's var\r\nasync function GetToken(flagString) {\r\n    if (flagString == null || flagString.length == 0) {\r\n        return;\r\n    }\r\n\r\n    var result = flagString.split('&').reduce(function (res, item) {\r\n        var parts = item.split('=');\r\n        res[parts[0]] = parts[1];\r\n        return res;\r\n    }, {});\r\n\r\n    // return Token\r\n    return result.access_token;\r\n}\r\n\r\nexport default GetToken;","import axios from \"axios\";\r\n\r\n// send users to twitch login page\r\nasync function GetAccess(clientId, redirect_uri) {\r\n    var claims = { \"id_token\": { \"email_verified\": null } };\r\n    const twitchUrl = `https://id.twitch.tv/oauth2/authorize?response_type=token+id_token&client_id=${clientId}&redirect_uri=${redirect_uri}&&scope=viewing_activity_read+openid&claims=${claims}`;\r\n\r\n    // refresh Url\r\n    await window.location.replace(twitchUrl);\r\n}\r\n\r\nexport default GetAccess;","import React, { useEffect, useState } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport axios from 'axios';\r\nimport { Card, CardColumns, Figure } from 'react-bootstrap';\r\n\r\nfunction IFrame({ height, width, allowfullscreen, autoplay, videoId, title, description, parent }) {\r\n    return (\r\n        <Card border=\"light\" style={{ width: '400px' }}>\r\n            {/* <div style={{ width: \"400px\", margin: \"10px\", marginRight: \"-50px\", display: \"inline-block\" }}> */}\r\n            <iframe\r\n                src={`https://player.twitch.tv/?autoplay=${autoplay == null ? false : true}&parent=${parent}&video=${videoId}`}\r\n                height={height == null ? 300 : height}\r\n                width={width == null ? 400 : width}\r\n                allowfullscreen={allowfullscreen == null ? `allowFullScreen` : allowfullscreen}\r\n            ></iframe>\r\n            {/* </div> */}\r\n            <Card.Header>{title}</Card.Header>\r\n            <Card.Body>\r\n            </Card.Body>\r\n        </Card>\r\n    );\r\n}\r\n\r\nexport default IFrame;","import React, { useEffect, useState } from 'react';\r\nimport IFrame from \"./IFrame\";\r\nimport { CardGroup, Container, CardDeck, CardColumns } from 'react-bootstrap';\r\n\r\nfunction GenerateIFrame(props) {\r\n    var twitchGameData = props.twitchGameData;\r\n    var parentDomain = props.parentDomain;\r\n\r\n    if (twitchGameData == null || twitchGameData.length == 0) {\r\n        console.log(\"twitchGameData is empty\");\r\n        return (<></>);\r\n    }\r\n    console.log(parentDomain);\r\n    return (<CardColumns>\r\n        {\r\n            twitchGameData.map(element => {\r\n                return <IFrame key={element.id} videoId={element.id} title={element.title} description={element.description} parent={parentDomain}></IFrame>\r\n            })\r\n        }\r\n    </CardColumns>);\r\n}\r\n\r\nexport default GenerateIFrame;","import React, { useEffect, useState } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport axios from 'axios';\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport GetToken from '../feature/GetToken';\r\nimport GetAccess from \"../feature/GetAccess\";\r\nimport GenerateIFrame from \"../components/GenerateIFrame\";\r\nimport IFrame from \"./IFrame\";\r\nimport { Card, CardColumns, Alert, Container } from 'react-bootstrap';\r\n\r\nfunction GenerateVideoCard({ gameName }) {\r\n    console.log(\"render\");\r\n    const dispatch = useDispatch();\r\n\r\n    const [accessToken, setAccessToken] = useState(\"\");\r\n    const [twitchGameData, setTwitchGameData] = useState([]);\r\n    const [gameId, setGameId] = useState(\"\");\r\n\r\n    const clientId = useSelector((state) => state.clientId);\r\n    const redirect_uri = useSelector((state) => state.redirect_uri);\r\n    const parentDomain = useSelector(state => state.parentDomain);\r\n\r\n    useEffect(async () => {\r\n        await OIDCImplicitCodeFlow();\r\n    }, []);\r\n\r\n    async function OIDCImplicitCodeFlow() {\r\n        // On your server, get an access token and ID token by making this request:\r\n        // json POST https://id.twitch.tv/oauth2/token ?client_id=<your client ID> &client_secret=<your client secret> &code=<authorization code received above> &grant_type=authorization_code &redirect_uri=<your registered redirect URI>\r\n        const flagString = document.location.hash.substr(1);\r\n\r\n        if (flagString == \"\") {\r\n            await GetAccess(clientId, redirect_uri);\r\n        }\r\n        else {\r\n            const access_Token = await GetToken(flagString);\r\n            dispatch({ type: \"accessToken\", accessToken: access_Token });\r\n            setAccessToken(access_Token);\r\n        }\r\n    }\r\n\r\n    // get data of game id \r\n    useEffect(async () => {\r\n        if (accessToken == \"\") {\r\n            console.log(\"access token is empty\");\r\n            return;\r\n        }\r\n\r\n        const response = await axios.get(`https://api.twitch.tv/helix/games?name=${gameName}`, {\r\n            headers: {\r\n                Authorization: `Bearer ${accessToken}`,\r\n                \"Client-Id\": `${clientId}`\r\n            }\r\n        });\r\n\r\n        if (response.status == 200 && response.data != null && response.data.data.length != 0) {\r\n            setGameId(response.data.data[0].id);\r\n            console.log(response.data.data[0].id);\r\n        }\r\n        else {\r\n            console.log(`response's data is empty`);\r\n            console.log(response);\r\n        }\r\n\r\n        // if (response.data.data == null || response.data.data.length == 0) {\r\n        //     return;\r\n        // }\r\n\r\n        // const gameId = response.data.data[0].id;\r\n\r\n        // const responseGameVideo = await axios.get(\r\n        //     `https://api.twitch.tv/helix/videos?game_id=${gameId}&first=20`\r\n        //     //`https://api.twitch.tv/helix/videos?game_id=1848487811&first=20`\r\n        //     , {\r\n        //         headers: {\r\n        //             Authorization: `Bearer ${accessToken}`,\r\n        //             \"Client-Id\": `${clientId}`\r\n        //         }\r\n        //     });\r\n        // console.log(responseGameVideo);\r\n        // setTwitchGameData(responseGameVideo.data.data);\r\n    }, [accessToken, gameName]);\r\n\r\n    // get videos by gameId\r\n    useEffect(async () => {\r\n        if (!gameId) {\r\n            return;\r\n        }\r\n\r\n        const responseGameVideo = await axios.get(\r\n            `https://api.twitch.tv/helix/videos?game_id=${gameId}&first=20`\r\n            //`https://api.twitch.tv/helix/videos?game_id=1848487811&first=20`\r\n            , {\r\n                headers: {\r\n                    Authorization: `Bearer ${accessToken}`,\r\n                    \"Client-Id\": `${clientId}`\r\n                }\r\n            });\r\n\r\n        setTwitchGameData(responseGameVideo.data.data);\r\n    }, [gameId]);\r\n\r\n    return (<Container >\r\n        {(twitchGameData == null || twitchGameData.length == 0) ? <Alert show={true} variant=\"info\">查無資料</Alert> : <></>}\r\n        <GenerateIFrame twitchGameData={twitchGameData} parentDomain={parentDomain}></GenerateIFrame>\r\n    </Container >);\r\n}\r\n\r\nexport default GenerateVideoCard;","import \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport { Provider } from \"react-redux\";\r\nimport store from './store';\r\nimport GenerateVideoCard from \"./components/GenerateVideoCard\";\r\nimport { BrowserRouter, Route, Switch } from 'react-router-dom';\r\nimport Navbar from \"react-bootstrap/Navbar\";\r\nimport { Nav, Button, Form, FormControl } from \"react-bootstrap\";\r\nimport { useState } from \"react\";\r\n\r\nfunction App() {\r\n  const [gameName, setGameName] = useState(\"\");\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n\r\n  function onChange(e) {\r\n    setSearchValue(e.target.value);\r\n    setGameName(\"\");\r\n  }\r\n\r\n  function onClick(e) {\r\n    setGameName(searchValue);\r\n  }\r\n\r\n  return (\r\n    <Provider store={store}>\r\n      <BrowserRouter>\r\n        <>\r\n          <Navbar expand=\"lg\" bg=\"dark\" variant=\"dark\">\r\n            <Nav className=\"container-fluid\" >\r\n              <Navbar.Brand>{`煥煥的選擇`}</Navbar.Brand>\r\n              <Form inline className=\"ml-auto\">\r\n                <FormControl type=\"input\" placeholder=\"Search Game Name\" className=\"mr-sm-2\" onChange={onChange} onKeyPress={onClick} />\r\n                <Button variant=\"outline-success\" onClick={onClick}>Search</Button>\r\n              </Form>\r\n            </Nav>\r\n          </Navbar>\r\n        </>\r\n        <Switch>\r\n          {/* <Route path=\"/twitch-app/videos\"> */}\r\n          <GenerateVideoCard gameName={gameName} />\r\n          {/* </Route> */}\r\n        </Switch>\r\n      </BrowserRouter>\r\n    </Provider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}